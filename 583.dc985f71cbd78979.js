"use strict";(self.webpackChunkbebpo_webmail_ui=self.webpackChunkbebpo_webmail_ui||[]).push([[583],{2583:(ye,A,r)=>{r.r(A),r.d(A,{NewMessageModule:()=>m});var c=r(6895),l=r(4006),e=r(4650),D=r(9751),F=r(4986),E=r(3532);const O=["fileSelector"];function q(n,o){if(1&n&&(e.TgZ(0,"div",8),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.dropZoneLabel)}}function U(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div")(1,"input",9),e.NdJ("click",function(a){e.CHM(t);const s=e.oxw(2);return e.KtG(s.openFileSelector(a))}),e.qZA()()}if(2&n){const t=e.oxw(2);e.xp6(1),e.s9C("value",t.browseBtnLabel),e.Q6J("className",t.browseBtnClassName)}}function I(n,o){if(1&n&&(e.YNc(0,q,2,1,"div",6),e.YNc(1,U,2,2,"div",7)),2&n){const t=e.oxw();e.Q6J("ngIf",t.dropZoneLabel),e.xp6(1),e.Q6J("ngIf",t.showBrowseBtn)}}function J(n,o){}const L=function(n){return{openFileSelector:n}};class b{constructor(o,t){this.relativePath=o,this.fileEntry=t}}let N=(()=>{class n{constructor(t){this.template=t}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.Rgc))},n.\u0275dir=e.lG2({type:n,selectors:[["","ngx-file-drop-content-tmp",""]]}),n})(),y=(()=>{class n{constructor(t,i){this.zone=t,this.renderer=i,this.accept="*",this.directory=!1,this.multiple=!0,this.dropZoneLabel="",this.dropZoneClassName="ngx-file-drop__drop-zone",this.useDragEnter=!1,this.contentClassName="ngx-file-drop__content",this.showBrowseBtn=!1,this.browseBtnClassName="btn btn-primary btn-xs ngx-file-drop__browse-btn",this.browseBtnLabel="Browse files",this.onFileDrop=new e.vpe,this.onFileOver=new e.vpe,this.onFileLeave=new e.vpe,this.isDraggingOverDropZone=!1,this.globalDraggingInProgress=!1,this.files=[],this.numOfActiveReadEntries=0,this.helperFormEl=null,this.fileInputPlaceholderEl=null,this.dropEventTimerSubscription=null,this._disabled=!1,this.openFileSelector=a=>{this.fileSelector&&this.fileSelector.nativeElement&&this.fileSelector.nativeElement.click()},this.globalDragStartListener=this.renderer.listen("document","dragstart",a=>{this.globalDraggingInProgress=!0}),this.globalDragEndListener=this.renderer.listen("document","dragend",a=>{this.globalDraggingInProgress=!1})}get disabled(){return this._disabled}set disabled(t){this._disabled=null!=t&&"false"!=`${t}`}ngOnDestroy(){this.dropEventTimerSubscription&&(this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=null),this.globalDragStartListener(),this.globalDragEndListener(),this.files=[],this.helperFormEl=null,this.fileInputPlaceholderEl=null}onDragOver(t){this.useDragEnter?(this.preventAndStop(t),t.dataTransfer&&(t.dataTransfer.dropEffect="copy")):!this.isDropzoneDisabled()&&!this.useDragEnter&&t.dataTransfer&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(t)),this.preventAndStop(t),t.dataTransfer.dropEffect="copy")}onDragEnter(t){!this.isDropzoneDisabled()&&this.useDragEnter&&(this.isDraggingOverDropZone||(this.isDraggingOverDropZone=!0,this.onFileOver.emit(t)),this.preventAndStop(t))}onDragLeave(t){this.isDropzoneDisabled()||(this.isDraggingOverDropZone&&(this.isDraggingOverDropZone=!1,this.onFileLeave.emit(t)),this.preventAndStop(t))}dropFiles(t){if(!this.isDropzoneDisabled()&&(this.isDraggingOverDropZone=!1,t.dataTransfer)){let i;i=t.dataTransfer.items?t.dataTransfer.items:t.dataTransfer.files,this.preventAndStop(t),this.checkFiles(i)}}uploadFiles(t){!this.isDropzoneDisabled()&&t.target&&(this.checkFiles(t.target.files||[]),this.resetFileInput())}getFakeDropEntry(t){const i={name:t.name,isDirectory:!1,isFile:!0,file:a=>a(t)};return new b(i.name,i)}checkFile(t){if(t){if("webkitGetAsEntry"in t){let i=t.webkitGetAsEntry();if(i){if(i.isFile){const a=new b(i.name,i);this.addToQueue(a)}else i.isDirectory&&this.traverseFileTree(i,i.name);return}}this.addToQueue(this.getFakeDropEntry(t))}}checkFiles(t){for(let i=0;i<t.length;i++)this.checkFile(t[i]);this.dropEventTimerSubscription&&this.dropEventTimerSubscription.unsubscribe(),this.dropEventTimerSubscription=function S(n=0,o,t=F.P){let i=-1;return null!=o&&((0,E.K)(o)?t=o:i=o),new D.y(a=>{let s=function w(n){return n instanceof Date&&!isNaN(n)}(n)?+n-t.now():n;s<0&&(s=0);let p=0;return t.schedule(function(){a.closed||(a.next(p++),0<=i?this.schedule(void 0,i):a.complete())},s)})}(200,200).subscribe(()=>{if(this.files.length>0&&0===this.numOfActiveReadEntries){const i=this.files;this.files=[],this.onFileDrop.emit(i)}})}traverseFileTree(t,i){if(t.isFile){const a=new b(i,t);this.files.push(a)}else{i+="/";const a=t.createReader();let s=[];const p=()=>{this.numOfActiveReadEntries++,a.readEntries(f=>{if(f.length)s=s.concat(f),p();else if(0===s.length){const h=new b(i,t);this.zone.run(()=>{this.addToQueue(h)})}else for(let h=0;h<s.length;h++)this.zone.run(()=>{this.traverseFileTree(s[h],i+s[h].name)});this.numOfActiveReadEntries--})};p()}}resetFileInput(){if(this.fileSelector&&this.fileSelector.nativeElement){const t=this.fileSelector.nativeElement,i=t.parentElement,a=this.getHelperFormElement(),s=this.getFileInputPlaceholderElement();i!==a&&(this.renderer.insertBefore(i,s,t),this.renderer.appendChild(a,t),a.reset(),this.renderer.insertBefore(i,t,s),this.renderer.removeChild(i,s))}}getHelperFormElement(){return this.helperFormEl||(this.helperFormEl=this.renderer.createElement("form")),this.helperFormEl}getFileInputPlaceholderElement(){return this.fileInputPlaceholderEl||(this.fileInputPlaceholderEl=this.renderer.createElement("div")),this.fileInputPlaceholderEl}isDropzoneDisabled(){return this.globalDraggingInProgress||this.disabled}addToQueue(t){this.files.push(t)}preventAndStop(t){t.stopPropagation(),t.preventDefault()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.R0b),e.Y36(e.Qsj))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ngx-file-drop"]],contentQueries:function(t,i,a){if(1&t&&e.Suo(a,N,5,e.Rgc),2&t){let s;e.iGM(s=e.CRH())&&(i.contentTemplate=s.first)}},viewQuery:function(t,i){if(1&t&&e.Gf(O,7),2&t){let a;e.iGM(a=e.CRH())&&(i.fileSelector=a.first)}},inputs:{accept:"accept",directory:"directory",multiple:"multiple",dropZoneLabel:"dropZoneLabel",dropZoneClassName:"dropZoneClassName",useDragEnter:"useDragEnter",contentClassName:"contentClassName",showBrowseBtn:"showBrowseBtn",browseBtnClassName:"browseBtnClassName",browseBtnLabel:"browseBtnLabel",disabled:"disabled"},outputs:{onFileDrop:"onFileDrop",onFileOver:"onFileOver",onFileLeave:"onFileLeave"},decls:7,vars:15,consts:[[3,"className","drop","dragover","dragenter","dragleave"],[3,"className"],["type","file",1,"ngx-file-drop__file-input",3,"accept","multiple","change"],["fileSelector",""],["defaultContentTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","ngx-file-drop__drop-zone-label",4,"ngIf"],[4,"ngIf"],[1,"ngx-file-drop__drop-zone-label"],["type","button",3,"className","value","click"]],template:function(t,i){if(1&t&&(e.TgZ(0,"div",0),e.NdJ("drop",function(s){return i.dropFiles(s)})("dragover",function(s){return i.onDragOver(s)})("dragenter",function(s){return i.onDragEnter(s)})("dragleave",function(s){return i.onDragLeave(s)}),e.TgZ(1,"div",1)(2,"input",2,3),e.NdJ("change",function(s){return i.uploadFiles(s)}),e.qZA(),e.YNc(4,I,2,2,"ng-template",null,4,e.W1O),e.YNc(6,J,0,0,"ng-template",5),e.qZA()()),2&t){const a=e.MAs(5);e.ekj("ngx-file-drop__drop-zone--over",i.isDraggingOverDropZone),e.Q6J("className",i.dropZoneClassName),e.xp6(1),e.Q6J("className",i.contentClassName),e.xp6(1),e.Q6J("accept",i.accept)("multiple",i.multiple),e.uIk("directory",i.directory||void 0)("webkitdirectory",i.directory||void 0)("mozdirectory",i.directory||void 0)("msdirectory",i.directory||void 0)("odirectory",i.directory||void 0),e.xp6(4),e.Q6J("ngTemplateOutlet",i.contentTemplate||a)("ngTemplateOutletContext",e.VKq(13,L,i.openFileSelector))}},dependencies:[c.O5,c.tP],styles:[".ngx-file-drop__drop-zone[_ngcontent-%COMP%]{height:100px;margin:auto;border:2px dotted #0782d0;border-radius:30px}.ngx-file-drop__drop-zone--over[_ngcontent-%COMP%]{background-color:#93939380}.ngx-file-drop__content[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;height:100px;color:#0782d0}.ngx-file-drop__drop-zone-label[_ngcontent-%COMP%]{text-align:center}.ngx-file-drop__file-input[_ngcontent-%COMP%]{display:none}"]}),n})(),z=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n,bootstrap:[y]}),n.\u0275inj=e.cJS({providers:[],imports:[c.ez]}),n})();var Q=r(4466),k=r(5378),Z=r(2731),T=r(8940),Y=r(7579),C=r(9936),P=r(8505),R=r(262),j=r(515),B=r(4556),$=r(3763),G=r(5134),M=r(4333),x=r(4463);class _{}_.\u0275fac=function(o){return new(o||_)},_.\u0275cmp=e.Xpm({type:_,selectors:[["app-expand-row"]],inputs:{account:"account"},decls:42,vars:24,consts:[[1,"row"],[1,"col-md-3"],[1,"col-md-6"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p"),e._uU(3),e.ALo(4,"translate"),e.qZA()(),e.TgZ(5,"div",2),e._uU(6),e.qZA()(),e.TgZ(7,"div",0)(8,"div",1)(9,"p"),e._uU(10),e.ALo(11,"translate"),e.qZA()(),e.TgZ(12,"div",2),e._uU(13),e.qZA()(),e.TgZ(14,"div",0)(15,"div",1)(16,"p"),e._uU(17),e.ALo(18,"translate"),e.qZA()(),e.TgZ(19,"div",2),e._uU(20),e.qZA()(),e.TgZ(21,"div",0)(22,"div",1)(23,"p"),e._uU(24),e.ALo(25,"translate"),e.qZA()(),e.TgZ(26,"div",2),e._uU(27),e.qZA()(),e.TgZ(28,"div",0)(29,"div",1)(30,"p"),e._uU(31),e.ALo(32,"translate"),e.qZA()(),e.TgZ(33,"div",2),e._uU(34),e.qZA()(),e.TgZ(35,"div",0)(36,"div",1)(37,"p"),e._uU(38),e.ALo(39,"translate"),e.qZA()(),e.TgZ(40,"div",2),e._uU(41),e.qZA()()),2&o&&(e.xp6(3),e.Oqu(e.lcZ(4,12,"label.organization")),e.xp6(3),e.Oqu(t.account.organization),e.xp6(4),e.Oqu(e.lcZ(11,14,"label.firstName")),e.xp6(3),e.Oqu(t.account.givenName),e.xp6(4),e.Oqu(e.lcZ(18,16,"label.lastName")),e.xp6(3),e.Oqu(t.account.surname),e.xp6(4),e.Oqu(e.lcZ(25,18,"label.email")),e.xp6(3),e.Oqu(t.account.email),e.xp6(4),e.Oqu(e.lcZ(32,20,"label.city")),e.xp6(3),e.Oqu(t.account.city),e.xp6(4),e.Oqu(e.lcZ(39,22,"label.postalCode")),e.xp6(3),e.Oqu(t.account.postalCode))},dependencies:[x.X$],styles:["p[_ngcontent-%COMP%]{font-weight:700}"],changeDetection:0});var H=r(3787);function K(n,o){1&n&&(e.TgZ(0,"span",4),e._UZ(1,"i",17),e.qZA())}function V(n,o){1&n&&(e.TgZ(0,"span",4),e._UZ(1,"i",18),e.qZA())}function X(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",15),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.enableSearch=!a.enableSearch)}),e.YNc(1,K,2,0,"span",16),e.YNc(2,V,2,0,"span",16),e.qZA()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.enableSearch),e.xp6(1),e.Q6J("ngIf",!t.enableSearch)}}function W(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",19)(1,"form",20)(2,"div",21)(3,"div",22),e._UZ(4,"input",23),e.ALo(5,"translate"),e.qZA(),e.TgZ(6,"div",22),e._UZ(7,"input",24),e.ALo(8,"translate"),e.qZA(),e.TgZ(9,"div",22),e._UZ(10,"input",25),e.ALo(11,"translate"),e.qZA(),e.TgZ(12,"div",22),e._UZ(13,"input",26),e.ALo(14,"translate"),e.qZA(),e.TgZ(15,"div",22),e._UZ(16,"input",27),e.ALo(17,"translate"),e.qZA()(),e.TgZ(18,"div",28)(19,"div")(20,"button",29),e._UZ(21,"i",30),e._uU(22),e.ALo(23,"translate"),e.qZA()(),e.TgZ(24,"button",31),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.submitSearch())}),e._uU(25),e.ALo(26,"translate"),e.qZA()()()()}if(2&n){const t=e.oxw();e.xp6(1),e.Q6J("formGroup",t.searchForm),e.xp6(3),e.Q6J("placeholder",e.lcZ(5,8,"placeholder.search.firstName")),e.xp6(3),e.Q6J("placeholder",e.lcZ(8,10,"placeholder.search.lastName")),e.xp6(3),e.Q6J("placeholder",e.lcZ(11,12,"placeholder.search.organization")),e.xp6(3),e.Q6J("placeholder",e.lcZ(14,14,"placeholder.search.organizationalUnit")),e.xp6(3),e.Q6J("placeholder",e.lcZ(17,16,"placeholder.search.city")),e.xp6(6),e.hij(" ",e.lcZ(23,18,"button.resetFilter")," "),e.xp6(3),e.hij(" ",e.lcZ(26,20,"button.search")," ")}}function ee(n,o){1&n&&e._UZ(0,"i",49)}function te(n,o){1&n&&e._UZ(0,"i",50)}function ne(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",51),e._UZ(2,"app-expand-row",52),e.qZA()()),2&n){const t=e.oxw(3);e.xp6(2),e.Q6J("account",t.selectedAccount)}}const oe=function(n){return{"highlight-row":n}};function ie(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tr",42),e.NdJ("click",function(){const a=e.CHM(t),s=a.$implicit,p=a.index,f=e.oxw(2);return e.KtG(f.saveSelectedAccount(s,p))}),e.TgZ(2,"td",43),e._uU(3),e.qZA(),e.TgZ(4,"td",43),e._uU(5),e.qZA(),e.TgZ(6,"td",43),e._uU(7),e.qZA(),e.TgZ(8,"td",43),e._uU(9),e.qZA(),e.TgZ(10,"td",43),e._uU(11),e.qZA(),e.TgZ(12,"td",44)(13,"button",45),e.NdJ("click",function(){const s=e.CHM(t).$implicit;return e.KtG(s.isExpanded=!s.isExpanded)}),e.ALo(14,"translate"),e.TgZ(15,"span"),e.YNc(16,ee,1,0,"i",46),e.YNc(17,te,1,0,"i",47),e.qZA()()()(),e.YNc(18,ne,3,1,"tr",48),e.BQk()}if(2&n){const t=o.$implicit,i=o.index,a=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.VKq(13,oe,a.selectedRowIndex===i)),e.xp6(2),e.Oqu(a.getFullName(t)),e.xp6(2),e.Oqu(t.organization),e.xp6(2),e.Oqu(t.organizationalUnit),e.xp6(2),e.Oqu(t.city),e.xp6(2),e.Oqu(t.egvpRoleID),e.xp6(2),e.Q6J("tooltip",e.lcZ(14,11,"title.info"))("position",a.position.ABOVE),e.xp6(3),e.Q6J("ngIf",!t.isExpanded),e.xp6(1),e.Q6J("ngIf",t.isExpanded),e.xp6(1),e.Q6J("ngIf",t.isExpanded&&a.selectedAccount)}}function ae(n,o){if(1&n&&(e.TgZ(0,"option"),e._uU(1),e.qZA()),2&n){const t=o.$implicit;e.xp6(1),e.Oqu(t)}}const se=function(n,o,t){return{itemsPerPage:n,currentPage:o,totalItems:t}};function re(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",32)(1,"table",33)(2,"thead")(3,"tr")(4,"th",34),e._uU(5),e.ALo(6,"translate"),e.qZA(),e.TgZ(7,"th",34),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"th",34),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.TgZ(13,"th",34),e._uU(14),e.ALo(15,"translate"),e.qZA(),e.TgZ(16,"th",34),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"th",35),e._uU(20),e.ALo(21,"translate"),e.qZA()()(),e.TgZ(22,"tbody"),e.YNc(23,ie,19,15,"ng-container",36),e.ALo(24,"paginate"),e.qZA()(),e.TgZ(25,"div",21)(26,"div",37)(27,"pagination-controls",38),e.NdJ("pageChange",function(a){e.CHM(t);const s=e.oxw();return e.KtG(s.onTableDataChange(a))}),e.qZA()(),e.TgZ(28,"div",39)(29,"span",40),e._uU(30),e.ALo(31,"translate"),e.qZA(),e.TgZ(32,"div")(33,"select",41),e.NdJ("ngModelChange",function(a){e.CHM(t);const s=e.oxw();return e.KtG(s.pageSize=a)})("change",function(a){e.CHM(t);const s=e.oxw();return e.KtG(s.onPageSizeChange(a))}),e.YNc(34,ae,2,1,"option",36),e.qZA()()()()()}if(2&n){const t=o.ngIf,i=e.oxw();e.xp6(5),e.Oqu(e.lcZ(6,11,"table.name")),e.xp6(3),e.Oqu(e.lcZ(9,13,"table.organization")),e.xp6(3),e.Oqu(e.lcZ(12,15,"table.organizationalUnit")),e.xp6(3),e.Oqu(e.lcZ(15,17,"table.city")),e.xp6(3),e.Oqu(e.lcZ(18,19,"table.roles")),e.xp6(3),e.Oqu(e.lcZ(21,21,"table.actions")),e.xp6(3),e.Q6J("ngForOf",e.xi3(24,23,t,e.kEZ(28,se,i.pageSize,i.page,i.total))),e.xp6(4),e.Q6J("maxSize",5),e.xp6(3),e.Oqu(e.lcZ(31,26,"label.itemsPerPage")),e.xp6(3),e.Q6J("ngModel",i.pageSize),e.xp6(1),e.Q6J("ngForOf",i.tableSizes)}}class v{constructor(o,t,i){this.bsModalRef=o,this.searchService=t,this.spinner=i,this.position=B.D,this.tableSizes=[2,10,20,50],this.total=0,this.pageSize=2,this.page=1,this.enableSearch=!0,this.accountIsSelected=!1,this.searchForm=new l.cw({displayName:new l.NI(""),firstName:new l.NI(""),lastName:new l.NI(""),organization:new l.NI(""),organizationalUnit:new l.NI(""),city:new l.NI(""),role:new l.NI("")})}close(){this.bsModalRef.hide()}submitSearch(){this.spinner.show(),console.log("search using this form "+JSON.stringify(this.searchForm.value)),this.accounts$=this.searchService.getAccountsResult().pipe((0,P.b)({next:o=>{this.total=o.length},complete:()=>this.spinner.hide()}),(0,R.K)(o=>(this.spinner.hide(),j.E)))}onTableDataChange(o){this.page=o,this.submitSearch()}onPageSizeChange(o){this.page=1,this.pageSize=o.target.value,this.submitSearch()}getFullName(o){return`${o.surname}, ${o.givenName}`}saveSelectedAccount(o,t){this.selectedRowIndex=t,this.selectedAccount=o,console.log("the selected user is: "+this.selectedAccount.givenName),this.accountIsSelected=!0}navigateToMessagePage(){null!=this.bsModalRef.content.callback&&this.bsModalRef.content.callback(this.selectedAccount),this.bsModalRef.hide()}}v.\u0275fac=function(o){return new(o||v)(e.Y36(T.UZ),e.Y36($.o),e.Y36(G.b))},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-search-modal"]],decls:25,vars:18,consts:[["role","dialog"],[1,"modal-header"],[1,"modal-title"],["type","button","aria-label","Close",1,"modal-button-dark","pull-right",3,"click"],["aria-hidden","true"],[1,"fa-solid","fa-xmark","fa-xl","text-light"],[1,"modal-body"],["id","filter",1,"card","shadow-sm","my-4"],[1,"card-header","d-flex","justify-content-between"],["type","button","class","btn float-end gov-btn-icon-primary bg-transparent",3,"click",4,"ngIf"],["class","card-body",4,"ngIf"],["id","accounts","class","container",4,"ngIf"],[1,"modal-footer"],["type","button",1,"gov-btn-secondary-md",3,"click"],["type","button",1,"gov-btn-primary-md",3,"disabled","click"],["type","button",1,"btn","float-end","gov-btn-icon-primary","bg-transparent",3,"click"],["aria-hidden","true",4,"ngIf"],[1,"fa-solid","fa-eye-slash","fa-xl"],[1,"fa-solid","fa-eye","fa-xl"],[1,"card-body"],["name","search-form","autocomplete","off","novalidate","",3,"formGroup"],[1,"row"],[1,"col-md-4"],["type","text","name","firstName","formControlName","firstName",1,"custom-input",3,"placeholder"],["type","text","name","lastName","formControlName","lastName",1,"custom-input",3,"placeholder"],["type","text","name","organization","formControlName","organization",1,"custom-input",3,"placeholder"],["type","text","name","organizationalUnit","formControlName","organizationalUnit",1,"custom-input",3,"placeholder"],["type","text","name","city","formControlName","city",1,"custom-input",3,"placeholder"],[1,"d-flex","justify-content-end"],["type","reset",1,"btn","btn-simple-flat"],[1,"fa-solid","fa-arrow-rotate-left"],["type","button",1,"gov-btn-primary-lg",3,"click"],["id","accounts",1,"container"],[1,"table"],["scope","col"],["scope","col",1,"fixed-column-right"],[4,"ngFor","ngForOf"],[1,"col-md-6"],["previousLabel","","nextLabel","",3,"maxSize","pageChange"],[1,"col-md-6","d-flex","justify-content-end"],[1,"m-1"],[1,"custom-select",3,"ngModel","ngModelChange","change"],[1,"table-row",3,"ngClass","click"],[1,"col-trunc"],[1,"fixed-column-right","text-center"],["type","button",1,"btn",3,"tooltip","position","click"],["class","fa-solid fa-circle-info fa-xl gov-btn-icon-primary",4,"ngIf"],["class","fa-sharp fa-solid fa-circle-chevron-up fa-xl gov-btn-icon-primary",4,"ngIf"],[4,"ngIf"],[1,"fa-solid","fa-circle-info","fa-xl","gov-btn-icon-primary"],[1,"fa-sharp","fa-solid","fa-circle-chevron-up","fa-xl","gov-btn-icon-primary"],["colspan","12"],[3,"account"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div",1)(2,"p",2),e._uU(3),e.qZA(),e.TgZ(4,"button",3),e.NdJ("click",function(){return t.close()}),e.TgZ(5,"span",4),e._UZ(6,"i",5),e.qZA()()(),e.TgZ(7,"div",6)(8,"div",7)(9,"div",8)(10,"h4"),e._uU(11),e.ALo(12,"translate"),e.qZA(),e.YNc(13,X,3,2,"button",9),e.ALo(14,"async"),e.qZA(),e.YNc(15,W,27,22,"div",10),e.qZA(),e.YNc(16,re,35,32,"div",11),e.ALo(17,"async"),e.qZA(),e.TgZ(18,"div",12)(19,"button",13),e.NdJ("click",function(){return t.close()}),e._uU(20),e.ALo(21,"translate"),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return t.navigateToMessagePage()}),e._uU(23),e.ALo(24,"translate"),e.qZA()()()),2&o&&(e.xp6(3),e.Oqu(t.title),e.xp6(8),e.Oqu(e.lcZ(12,8,"heading.searchFilter")),e.xp6(2),e.Q6J("ngIf",e.lcZ(14,10,t.accounts$)),e.xp6(2),e.Q6J("ngIf",t.enableSearch),e.xp6(1),e.Q6J("ngIf",e.lcZ(17,12,t.accounts$)),e.xp6(4),e.hij(" ",e.lcZ(21,14,"button.cancel")," "),e.xp6(2),e.Q6J("disabled",!t.accountIsSelected),e.xp6(1),e.hij(" ",e.lcZ(24,16,"button.choose")," "))},dependencies:[c.mk,c.sg,c.O5,l._Y,l.YN,l.Kr,l.Fj,l.EJ,l.JJ,l.JL,l.On,M.LS,l.sg,l.u,_,H.i,c.Ov,M._s,x.X$],styles:[".fixed-column-right[_ngcontent-%COMP%]{position:sticky;z-index:90;right:0;width:100px;min-width:100px;background-color:#ffffff87}[_nghost-%COMP%]     .ngx-pagination{padding-left:0}[_nghost-%COMP%]     .ngx-pagination .current, .btn-info[_ngcontent-%COMP%]{border-radius:7px;background-color:var(--blue-i500)}[_nghost-%COMP%]     .ngx-pagination .current:hover{border-radius:7px;background-color:var(--blue-i900)}.table-row[_ngcontent-%COMP%]:hover, .highlight-row[_ngcontent-%COMP%]{background-color:var(--blue-i50)}"],changeDetection:0});var le=r(6350),d=r(2629),ce=r(4283),pe=r(1837),de=r(7512),ue=r(6199),ge=r(8332);function me(n,o){1&n&&(e.TgZ(0,"h2"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"title.newMessage")))}function fe(n,o){1&n&&(e.TgZ(0,"h2"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"title.replyMessage")))}function he(n,o){1&n&&(e.TgZ(0,"h2"),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n&&(e.xp6(1),e.Oqu(e.lcZ(2,1,"title.shareMessage")))}function _e(n,o){if(1&n&&(e.TgZ(0,"span",29),e._uU(1),e.qZA()),2&n){const t=e.oxw(2);e.xp6(1),e.Oqu(t.account.surname)}}function ve(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",8)(1,"div",24)(2,"label",25),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.YNc(5,_e,2,1,"span",26),e.TgZ(6,"button",27),e.NdJ("click",function(){e.CHM(t);const a=e.oxw();return e.KtG(a.openSearchModal())}),e._UZ(7,"i",28),e._uU(8),e.ALo(9,"translate"),e.qZA()()()}if(2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,3,"label.to")),e.xp6(2),e.Q6J("ngIf",t.account),e.xp6(3),e.hij(" ",e.lcZ(9,5,"button.addressBook")," ")}}function be(n,o){if(1&n&&(e.TgZ(0,"div",30)(1,"div",9)(2,"label",31),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"span",32),e._uU(6),e.qZA()()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,2,"label.to")),e.xp6(3),e.Oqu(t.currentEgvpMessage.sender)}}function xe(n,o){1&n&&(e.TgZ(0,"div",8)(1,"div",9)(2,"label",33),e._uU(3),e.ALo(4,"translate"),e.qZA(),e._UZ(5,"input",34),e.qZA()()),2&n&&(e.xp6(3),e.Oqu(e.lcZ(4,1,"label.subject")))}function Ze(n,o){if(1&n&&(e.TgZ(0,"div",35)(1,"div",9)(2,"label",36),e._uU(3),e.ALo(4,"translate"),e.qZA(),e.TgZ(5,"span",37),e._uU(6),e.qZA()()()),2&n){const t=e.oxw();e.xp6(3),e.Oqu(e.lcZ(4,2,"label.subject")),e.xp6(3),e.Oqu(t.subject)}}function Te(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",38)(1,"strong",39),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"button",40),e.NdJ("click",function(){const s=e.CHM(t).openFileSelector;return e.KtG(s())}),e._UZ(5,"i",41),e._uU(6),e.ALo(7,"translate"),e.qZA(),e.TgZ(8,"p",39)(9,"span"),e._uU(10),e.ALo(11,"translate"),e.qZA()()()}2&n&&(e.xp6(2),e.Oqu(e.lcZ(3,3,"label.dropAttachments")),e.xp6(4),e.hij(" ",e.lcZ(7,5,"button.addAttachment")," "),e.xp6(4),e.Oqu(e.lcZ(11,7,"label.fileSize")))}function Ce(n,o){1&n&&e._UZ(0,"hr")}function Ae(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div"),e.YNc(1,Ce,1,0,"hr",1),e.TgZ(2,"span"),e._uU(3),e.qZA(),e.TgZ(4,"button",42),e.NdJ("click",function(){const s=e.CHM(t).index,p=e.oxw();return e.KtG(p.deleteDoc(s))}),e._UZ(5,"i",5),e.qZA()()}if(2&n){const t=o.$implicit,i=o.index;e.xp6(1),e.Q6J("ngIf",0!==i),e.xp6(2),e.Oqu(t.name)}}class u{constructor(o,t,i,a,s,p,f){this.bsModalRef=o,this.modalService=t,this.cdRef=i,this.translate=a,this.router=s,this.messageService=p,this.fb=f,this.alertMessage$=new Y.x,this.messageTypeEnum=C.C,this.uploadedDocuments=[],this.currentUser={email:"sender.test@governikus.de",surname:"Gemeinde XY"},this.navigationExtras=this.router.getCurrentNavigation()?.extras,this.newEgvpMessage=new le.D}ngOnInit(){this.createMessageForm(),this.initialData(this.navigationExtras),this.createDraft()}ngAfterViewInit(){this.isCourtAccount()}close(){this.bsModalRef.hide()}sendMessage(){this.messageForm.patchValue({sender:this.currentUser.surname}),this.newEgvpMessage=Object.assign(this.newEgvpMessage,this.messageForm.value),this.newEgvpMessage.identifier=this.messageIdentifier,console.log("email gesendet "+JSON.stringify(this.newEgvpMessage)),this.messageService.sendMessage(this.messageIdentifier).subscribe({next:()=>{this.alertMessage$.next(d.b.customSuccess(this.translate.instant("message.success.messageSent"),!0))},error:o=>{this.alertMessage$.next(d.b.customError(this.translate.instant("message.error.newMessage",{error:o.message}),!0))}})}openSearchModal(){this.modalService.show(v,{class:"modal-xl modal-centered",backdrop:"static",initialState:{title:this.translate.instant("title.safeSearch"),callback:o=>{null!==o&&(this.account=o,this.messageForm.patchValue({primaryReceiver:o.email}),this.cdRef.detectChanges())}}})}initialData(o){this.currentEgvpMessage=o?.state?.message,this.type=o?.state?.type,this.subject=o?.state?.subject,this.type===C.C.SHARE?this.messageForm.patchValue({subject:this.subject}):this.type===C.C.REPLY&&this.messageForm.patchValue({subject:this.subject,primaryReceiver:this.currentEgvpMessage.sender})}isCourtAccount(){"egvp_behoerde"===this.account?.egvpRoleID&&(this.alertMessage$.next(d.b.customInfo(this.translate.instant("message.info.isCourt"),!1)),this.cdRef.detectChanges())}dropped(o){for(const t of o)if(t.fileEntry.isFile){const i=t.fileEntry;i.file(a=>{for(let s=0;s<this.uploadedDocuments.length;s++)if(this.uploadedDocuments[s].name.match(i.name))return void this.alertMessage$.next(d.b.customError(this.translate.instant("message.error.fileExists",{name:a.name}),!0));this.bytesToMB(a.size)>ce.V.FILE_MAX_SIZE_MB?this.alertMessage$.next(d.b.customError(this.translate.instant("message.error.fileSize",{name:a.name}),!0)):(this.uploadedDocuments.push(a),this.cdRef.detectChanges())})}}deleteDoc(o){this.uploadedDocuments.splice(o,1)}confirmDraftCreation(){this.modalService.show(pe.z,{class:"modal-lg",initialState:{title:this.translate.instant("modal.title.createDraft"),modalType:de.w.CONFIRM,confirmButtonName:this.translate.instant("button.discardMessage"),declineButtonName:this.translate.instant("button.saveAsDraft"),content:this.translate.instant("modal.content.createDraft"),callback:o=>{"confirm"===o&&console.log("message discarded")}}})}createDraft(){this.messageService.createCraft().subscribe({next:o=>{this.messageIdentifier=o},complete:()=>{this.alertMessage$.next(d.b.customInfo(this.translate.instant("message.info.draftCreated"),!0))},error:o=>{this.alertMessage$.next(d.b.customError(this.translate.instant("message.error.draftError")+o.message,!0))}})}bytesToMB(o){return(o/1048576).toFixed(2)}createMessageForm(){this.messageForm=this.fb.group({identifier:[""],subject:[""],sender:[""],primaryReceiver:[""],emailText:[""]})}}u.\u0275fac=function(o){return new(o||u)(e.Y36(T.UZ),e.Y36(T.tT),e.Y36(e.sBO),e.Y36(x.sK),e.Y36(Z.F0),e.Y36(ue.e),e.Y36(l.qu))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-new-message"]],decls:39,vars:23,consts:[[1,"col-md-11","offset-md-1","d-flex","justify-content-between","mt-3"],[4,"ngIf"],["type","button",1,"gov-btn-primary-md",3,"click"],["aria-hidden","true",1,"fa-sharp","fa-solid","fa-paper-plane"],["type","button",1,"gov-btn-icon-primary",3,"click"],[1,"fa-solid","fa-trash","fa-xl"],[1,"col-md-8","offset-md-1"],["name","new-message-form","autocomplete","off","novalidate","",1,"mt-3",3,"formGroup"],[1,"row"],[1,"d-inline-flex","align-items-center"],["for","sender-text",1,"custom-label"],["id","sender-text",1,"custom-label","sender-text"],["class","row",4,"ngIf"],["class","row mb-1",4,"ngIf"],["class","row mb-2",4,"ngIf"],["for","message",1,"custom-label"],["cols","2","rows","4","formControlName","emailText","id","message",1,"form-control","mt-2"],[1,"mt-4","mb-4"],[3,"dropZoneClassName","onFileDrop"],["ngx-file-drop-content-tmp",""],[1,"mt-5"],[4,"ngFor","ngForOf"],[1,"mt-3"],[3,"alert"],[1,"col-md-10","d-inline-flex","align-items-center"],["for","address-book",1,"custom-label"],["class","custom-label",4,"ngIf"],["id","address-book","type","reset",1,"btn","btn-simple-flat",3,"click"],[1,"fa","fa-address-book"],[1,"custom-label"],[1,"row","mb-1"],["for","receiver-label",1,"custom-label"],["id","receiver-label",1,"custom-label","sender-text"],["for","subject-input",1,"custom-label"],["id","subject-input","type","text","name","lastName","formControlName","subject",1,"custom-input"],[1,"row","mb-2"],["for","subject-label",1,"custom-label"],["id","subject-label",1,"custom-label","sender-text"],[1,"text-center"],[1,"text-secondary"],["id","attachment-button","type","button",1,"btn","btn-simple-flat",3,"click"],[1,"fa-solid","fa-paperclip"],["type","button",1,"btn-simple-flat","float-end",3,"click"]],template:function(o,t){1&o&&(e.TgZ(0,"div",0)(1,"div"),e.YNc(2,me,3,3,"h2",1),e.YNc(3,fe,3,3,"h2",1),e.YNc(4,he,3,3,"h2",1),e.qZA(),e.TgZ(5,"div")(6,"button",2),e.NdJ("click",function(){return t.sendMessage()}),e._UZ(7,"i",3),e._uU(8),e.ALo(9,"translate"),e.qZA(),e.TgZ(10,"button",4),e.NdJ("click",function(){return t.confirmDraftCreation()}),e._UZ(11,"i",5),e.qZA()()(),e.TgZ(12,"div",6)(13,"form",7)(14,"div",8)(15,"div",9)(16,"label",10),e._uU(17),e.ALo(18,"translate"),e.qZA(),e.TgZ(19,"span",11),e._uU(20),e.qZA()()(),e.YNc(21,ve,10,7,"div",12),e.YNc(22,be,7,4,"div",13),e.YNc(23,xe,6,3,"div",12),e.YNc(24,Ze,7,4,"div",14),e.TgZ(25,"div",8)(26,"div")(27,"label",15),e._uU(28),e.ALo(29,"translate"),e.qZA(),e._UZ(30,"textarea",16),e.qZA()(),e.TgZ(31,"div",17)(32,"ngx-file-drop",18),e.NdJ("onFileDrop",function(a){return t.dropped(a)}),e.YNc(33,Te,12,9,"ng-template",19),e.qZA(),e.TgZ(34,"div",20),e.YNc(35,Ae,6,2,"div",21),e.qZA()()(),e.TgZ(36,"div",22),e._UZ(37,"app-alert",23),e.ALo(38,"async"),e.qZA()()),2&o&&(e.xp6(2),e.Q6J("ngIf",t.type===t.messageTypeEnum.NEW),e.xp6(1),e.Q6J("ngIf",t.type===t.messageTypeEnum.REPLY),e.xp6(1),e.Q6J("ngIf",t.type===t.messageTypeEnum.SHARE),e.xp6(4),e.hij(" ",e.lcZ(9,15,"button.send")," "),e.xp6(5),e.Q6J("formGroup",t.messageForm),e.xp6(4),e.Oqu(e.lcZ(18,17,"label.from")),e.xp6(3),e.Oqu(t.currentUser.surname),e.xp6(1),e.Q6J("ngIf",t.type!==t.messageTypeEnum.REPLY),e.xp6(1),e.Q6J("ngIf",t.type===t.messageTypeEnum.REPLY),e.xp6(1),e.Q6J("ngIf",t.type===t.messageTypeEnum.NEW),e.xp6(1),e.Q6J("ngIf",t.type!==t.messageTypeEnum.NEW),e.xp6(4),e.Oqu(e.lcZ(29,19,"label.message")),e.xp6(4),e.Q6J("dropZoneClassName","dropzone"),e.xp6(3),e.Q6J("ngForOf",t.uploadedDocuments),e.xp6(2),e.Q6J("alert",e.lcZ(38,21,t.alertMessage$)))},dependencies:[c.sg,c.O5,y,N,l._Y,l.Fj,l.JJ,l.JL,l.sg,l.u,ge.w,c.Ov,x.X$],styles:[".sender-text[_ngcontent-%COMP%]{margin:12px}span[_ngcontent-%COMP%]{margin-bottom:2px;margin-left:12px}"],changeDetection:0});const Ne=[{path:"",component:u,children:[{path:"new-message",component:u}]}];class g{}g.\u0275fac=function(o){return new(o||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[Z.Bz.forChild(Ne),Z.Bz]});class m{}m.\u0275fac=function(o){return new(o||m)},m.\u0275mod=e.oAB({type:m}),m.\u0275inj=e.cJS({imports:[c.ez,g,z,l.UX,Q.m,k.z]})}}]);